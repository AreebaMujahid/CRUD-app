<!DOCTYPE html>
<html>
<head>
<title> my new page </title>
<link rel="stylesheet" type="text/css" href="index.css">
</head>
<body>
    <div class="main">
        <div class="myform">
        <form>
            <label for="name"> Name: </label>
            <input type="text" id="name" name="name"><br>

            <label for="email"> Email: </label>
            <input type="text" id="email" name="email"><br>

            <label for="phoneno"> Phone: </label>
            <input type="text" id="phone" name="phone"><br>

            <button id="btn" onclick="addDataToLocalStorage(event)"> add data </button>


        </form>
        </div>

        <br>
        <table id="table">
            <tr>
                <td> Name </td>
                <td> Email </td>
                <td> Phone no </td>
                <td> Actions </td>
                

            </tr>

        </table>

    </div>

    <script>


        function clearInputs()
        {
             document.getElementById("name").value = "";
             document.getElementById("email").value = "";
             document.getElementById("phone").value = "";
        }
        
        function saveDataToLocalStorage(data){
            localStorage.setItem('tableData',JSON.stringify(data));
        }

        function loadDataFromLocalStorage() {
            let storedData = JSON.parse(localStorage.getItem('tableData')) || [];

            // Loop through the stored data and add each entry to the table
            storedData.forEach(function(event) {
                addDataToTable(event.name,event.email,event.phone);
            });
        }
        
        function addDataToLocalStorage(event){
            
            let StoredData = JSON.parse(localStorage.getItem('tableData')) || [];
            let name = document.getElementById("name").value;     
            let email = document.getElementById("email").value;
            let phone = document.getElementById("phone").value;

            
            
            console.log(StoredData);
            StoredData.push({ name: name, email: email, phone: phone });
            saveDataToLocalStorage(StoredData);
            addDataToTable(name,email,phone);


        }
        function addDataToTable(name,email,phone)
        {
            
            
            
            let table = document.getElementById("table");
            let newrow = table.insertRow(table.rows.length);      
            newrow.insertCell(0).innerHTML = name;
            newrow.insertCell(1).innerHTML = email;
            newrow.insertCell(2).innerHTML = phone;
            newrow.insertCell(3).innerHTML = '<button onclick="editData(this)">Edit</button>' + '<button onclick="deleteData(this)">Delete</button>'
            
            

        }
        function deleteInLocalStorage(name)
        {
            let StoredData = JSON.parse(localStorage.getItem('tableData')) || [];
            console.log(StoredData);
            let updatedData = StoredData.filter(row => row.name.trim().toLowerCase() !== name.trim().toLowerCase())
            localStorage.setItem('tableData',JSON.stringify(updatedData));

        }
        function deleteData(button)
        {
            let row = button.parentNode.parentNode;
            row.parentNode.removeChild(row);
            let name = row.cells[0].innerHTML;
            deleteInLocalStorage(name);



        }
        function editInLocalStorage(name,email,phone){
            let StoredData = JSON.parse(localStorage.getItem('tableData')) || [];
            let rowToEdit = StoredData.find(row => row.name === name.innerHTML);
            if (rowToEdit) {
                rowToEdit.email = email;
                rowToEdit.phone = phone;
            }

            localStorage.setItem('tableData',JSON.stringify(StoredData))

        }

        function editData(button)    
        {
            
            let row = button.parentNode.parentNode;       
            let email = row.cells[1];
            let phone = row.cells[2];  
            let updatedEmail = prompt("Enter updated email" , email.innerHTML);
            let updatedPhone = prompt("Enter updated phone no" , phone.innerHTML);
            email.innerHTML = updatedEmail;
            phone.innerHTML = updatedPhone;

            let name = row.cells[0];
            editInLocalStorage(name,updatedEmail,updatedPhone);

        
        
        
        }
        window.onload = loadDataFromLocalStorage;

    </script> 


</body>
</html>
